ceil = x =>
  f = (flr x)
  (if (eql x f) f (add f 1))

binStr =>
  len = (sub (len binStr) 2)
  pad = (slc "0000" 0 (sub 3 (mod (add (len binStr) 1) 4)))
  bin = (con pad (slc binStr 2 (len binStr)))
  (con "0x"
    (for 0 (div (len bin) 4) "" n => r =>
      i = (mul n 4)
      j = (add i 4)
      b = (slc bin i j)
      (if (cmp b "0001") (con r "1")
      (if (cmp b "0010") (con r "2")
      (if (cmp b "0011") (con r "3")
      (if (cmp b "0100") (con r "4")
      (if (cmp b "0101") (con r "5")
      (if (cmp b "0110") (con r "6")
      (if (cmp b "0111") (con r "7")
      (if (cmp b "1000") (con r "8")
      (if (cmp b "1001") (con r "9")
      (if (cmp b "1010") (con r "a")
      (if (cmp b "1011") (con r "b")
      (if (cmp b "1100") (con r "c")
      (if (cmp b "1101") (con r "d")
      (if (cmp b "1110") (con r "e")
      (if (cmp b "1111") (con r "f")
      (con r "0"))))))))))))))))))
